{% extends 'base.html' %} {% block title %}Mentoring - AgriConnect{% endblock %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">
      <i class="fas fa-user-tie me-2"></i>Find an Expert Mentor
    </h2>
    {% if current_user.is_authenticated and current_user.is_expert() %}
    <a
      href="{{ url_for('mentoring.mentor_dashboard') }}"
      class="btn btn-success"
    >
      <i class="fas fa-chalkboard-teacher me-1"></i> Mentor Dashboard
    </a>
    {% endif %}
  </div>

  <form class="row g-2 mb-4" method="get">
    <div class="col-md-6">
      <input
        type="text"
        name="search"
        value="{{ search }}"
        class="form-control"
        placeholder="Search by specialization or bio"
      />
    </div>
    <div class="col-md-4">
      <input
        type="text"
        name="specialization"
        value="{{ specialization }}"
        class="form-control"
        placeholder="Filter by specialization"
      />
    </div>
    <div class="col-md-2 d-grid">
      <button class="btn btn-outline-success" type="submit">
        <i class="fas fa-search me-1"></i>Search
      </button>
    </div>
  </form>

  {% if mentors.items %}
  <div class="row">
    {% for mentor in mentors.items %} {% set user = mentor.get_user() %}
    <div class="col-md-6 col-lg-4 mb-3">
      <div class="card h-100 shadow-sm">
        <div class="card-body">
          <div class="d-flex align-items-center mb-2">
            <div
              class="bg-success text-white rounded-circle d-flex align-items-center justify-content-center"
              style="width: 44px; height: 44px"
            >
              <i class="fas fa-user-tie"></i>
            </div>
            <div class="ms-3">
              <h5 class="card-title mb-0">
                {{ user.get_full_name() if user else 'Expert Mentor' }}
              </h5>
              <small class="text-muted">{{ mentor.specialization }}</small>
            </div>
          </div>
          <p class="card-text text-muted">
            {{ mentor.bio[:140] }}{% if mentor.bio and mentor.bio|length > 140
            %}...{% endif %}
          </p>
          <div class="d-flex justify-content-between align-items-center">
            <span class="text-warning">
              <i class="fas fa-star"></i> {{ '%.1f' % (mentor.rating or 0) }}
            </span>
            <a
              href="{{ url_for('mentoring.mentor_profile', mentor_id=mentor.id) }}"
              class="btn btn-outline-success btn-sm"
            >
              View Profile
            </a>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <nav aria-label="Mentors pagination" class="mt-3">
    <ul class="pagination justify-content-center">
      <li class="page-item {% if not mentors.has_prev %}disabled{% endif %}">
        <a
          class="page-link"
          href="{{ url_for('mentoring.index', page=mentors.prev_num, search=search, specialization=specialization) }}"
          >Previous</a
        >
      </li>
      <li class="page-item disabled">
        <span class="page-link"
          >Page {{ mentors.page }} of {{ mentors.pages }}</span
        >
      </li>
      <li class="page-item {% if not mentors.has_next %}disabled{% endif %}">
        <a
          class="page-link"
          href="{{ url_for('mentoring.index', page=mentors.next_num, search=search, specialization=specialization) }}"
          >Next</a
        >
      </li>
    </ul>
  </nav>
  {% else %}
  <div class="alert alert-info">
    <i class="fas fa-info-circle me-2"></i>No mentors found. Try adjusting your
    search.
  </div>
  {% endif %}

  <div class="text-center mt-4">
    <a
      href="{{ url_for('mentoring.request_mentoring') }}"
      class="btn btn-primary"
    >
      <i class="fas fa-paper-plane me-1"></i>Request Mentoring
    </a>
  </div>
</div>
{% endblock %}
